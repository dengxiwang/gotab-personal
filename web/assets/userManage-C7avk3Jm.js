import{x as e,e as r,j as t,B as s,ao as l,a8 as i,ax as o,ah as a,ad as n,aC as m,a0 as c,ag as d,af as p,aj as u}from"./main-Drts11_7.js";import{T as h}from"./index-C6rEypNn.js";import{I as j}from"./assets-CmvcfQKP.js";import{u as f}from"./useFresh-Caa9CBBF.js";import{r as x}from"./transformData-4xpszoeT.js";import{M as y,R as w}from"./myTable-Wd7-qF4v.js";import{C as _}from"./contentLayout-zuNNcUeR.js";import{F as b}from"./index-DdMyc5Cn.js";import{I as g}from"./index-zfgypH5w.js";import{R as k,a as T}from"./SearchOutlined-DmWGW1ei.js";import{T as S}from"./index-C9FQ1vGg.js";import{I as C}from"./index-BjdmaOhY.js";import{P as I}from"./main-C0HDhtQF.js";import"./iconBase-BbVwZJJI.js";import"./MailOutlined-BnFe3ikS.js";import"./Overflow-BDgtIXVY.js";import"./mediaQueryUtil-DPPPwwPM.js";import"./index-B6TAr31U.js";import"./getAllowClear-CAqcmJNw.js";import"./Input-C1mipumm.js";import"./MoneyCollectOutlined-Bb9qYdKS.js";import"./MoneyCollectOutlined-4QlEwa2l.js";import"./index-l3YJAaFU.js";import"./styleChecker-DUtHXLCf.js";import"./AlipayOutlined-DZ2-V1fR.js";import"./AlipayOutlined-tZM3mGx9.js";import"./index-DzBdgDHo.js";import"./useBreakpoint-DFlb7uCR.js";import"./index-Dv1_3i3f.js";import"./row-DcPNg0q0.js";import"./QuestionCircleOutlined-DSm95oJP.js";import"./TextArea-CXkQ_emr.js";import"./LeftOutlined-D9Sp279J.js";function v(){const n=e.c(49),{key:m,refresh:c}=f(),[d]=b.useForm();let p;n[0]===Symbol.for("react.memo_cache_sentinel")?(p={},n[0]=p):p=n[0];const[u,h]=r.useState(p);let j,w,S,C,I,v,L,M,U,$,K,B;n[1]===Symbol.for("react.memo_cache_sentinel")?(j={title:"用户名",key:"username",width:160,fixed:"left"},C={title:"用户类型",key:"userType",width:120,render:N},I={title:"头像",key:"avatar",width:120,className:"flex-center",render:E},v={title:"昵称",key:"nickname",width:160},L={type:"sex",title:"性别",key:"sex",width:60},M={title:"邮箱",key:"email",width:200,render:F},U={title:"手机号",key:"phone",width:160,render:z},$={title:"称号",key:"appellation",width:200,render:P},K={title:"称号状态",key:"appellation_status",width:120,render:A},w={type:"time",title:"注册时间",key:"createdTime",width:200},S={type:"time",title:"更新时间",key:"updatedTime",width:200},n[1]=j,n[2]=w,n[3]=S,n[4]=C,n[5]=I,n[6]=v,n[7]=L,n[8]=M,n[9]=U,n[10]=$,n[11]=K):(j=n[1],w=n[2],S=n[3],C=n[4],I=n[5],v=n[6],L=n[7],M=n[8],U=n[9],$=n[10],K=n[11]),n[12]!==c?(B=[j,C,I,v,L,M,U,$,K,w,S,{title:"操作",fixed:"right",width:180,render:(e,r)=>t.jsx(Z,{record:r,refresh:c})}],n[12]=c,n[13]=B):B=n[13];const R=B;let q,D,Q,V,W,G,H,J,X,Y,ee,re,te,se,le,ie,oe;return n[14]!==d?(q=()=>{const e=d.getFieldsValue();e[Math.random()]=!0,h(x(e))},n[14]=d,n[15]=q):q=n[15],n[16]===Symbol.for("react.memo_cache_sentinel")?(D={gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gridTemplateRows:"32px"},n[16]=D):D=n[16],n[17]===Symbol.for("react.memo_cache_sentinel")?(Q=t.jsx(b.Item,{name:"username",children:t.jsx(g,{placeholder:"用户名"})}),n[17]=Q):Q=n[17],n[18]===Symbol.for("react.memo_cache_sentinel")?(V=t.jsxs("div",{className:"gap-3 flex-wrap grid w-full mb-3",style:D,children:[Q,t.jsx(b.Item,{name:"phone",children:t.jsx(g,{placeholder:"手机号"})})]}),n[18]=V):V=n[18],n[19]!==d?(W=()=>{d.submit()},n[19]=d,n[20]=W):W=n[20],n[21]===Symbol.for("react.memo_cache_sentinel")?(G=t.jsx(k,{}),n[21]=G):G=n[21],n[22]!==W?(H=t.jsx(s,{type:"primary",onClick:W,icon:G,children:"查询"}),n[22]=W,n[23]=H):H=n[23],n[24]!==d?(J=()=>{d.resetFields();const e={};e[Math.random()]=!0,h(e)},n[24]=d,n[25]=J):J=n[25],n[26]===Symbol.for("react.memo_cache_sentinel")?(X=t.jsx(T,{}),n[26]=X):X=n[26],n[27]!==J?(Y=t.jsx(s,{onClick:J,icon:X,children:"重置"}),n[27]=J,n[28]=Y):Y=n[28],n[29]!==H||n[30]!==Y?(ee=t.jsxs("div",{className:"flex flex-wrap gap-3",children:[H,Y]}),n[29]=H,n[30]=Y,n[31]=ee):ee=n[31],n[32]!==d||n[33]!==q||n[34]!==ee?(re=t.jsxs(b,{className:"w-full",form:d,onFinish:q,children:[V,ee]}),n[32]=d,n[33]=q,n[34]=ee,n[35]=re):re=n[35],n[36]===Symbol.for("react.memo_cache_sentinel")?(te=t.jsx(l,{className:"my-3"}),n[36]=te):te=n[36],n[37]!==c?(se=t.jsx("div",{className:"mb-3",children:t.jsx(s,{type:"primary",onClick:()=>{i.show(o,{title:"新增用户",children:t.jsx(O,{refresh:c})})},children:"新增用户"})}),n[37]=c,n[38]=se):se=n[38],n[39]!==u?(le={searchParams:u},n[39]=u,n[40]=le):le=n[40],n[41]!==R||n[42]!==m||n[43]!==le?(ie=t.jsx(y,{columns:R,getListUrl:a.getAwaitingApprovalUserAppellationList,dataKey:"data.list",rowKey:"userId",tableKey:m,params:le}),n[41]=R,n[42]=m,n[43]=le,n[44]=ie):ie=n[44],n[45]!==re||n[46]!==se||n[47]!==ie?(oe=t.jsxs(_,{children:[re,te,se,ie]}),n[45]=re,n[46]=se,n[47]=ie,n[48]=oe):oe=n[48],oe}function A(e,r){return t.jsx(S,{color:0===e?r.appellation?"blue":"default":1===e?"green":"red",children:0===e?r.appellation?"待审核":"未申请":1===e?"已荣获":"被拒绝"})}function P(e){return e?t.jsx(S,{className:"flex items-center gap-1 w-fit",icon:t.jsx(h,{}),children:e||"-"}):"-"}function z(e){return t.jsx(s,{type:"text",size:"small",onClick:()=>{m(e,!0)},children:e||"-"})}function F(e){return t.jsx(s,{type:"text",size:"small",onClick:()=>{m(e,!0)},children:e||"-"})}function E(e){return e?t.jsx(C,{src:n(e),height:48,fallback:j,loading:"lazy"}):"-"}function N(e){return t.jsx(S,{bordered:!1,color:0===e?"blue":"volcano",children:1===e?"管理员":"普通用户"})}const O=l=>{const n=e.c(13),{refresh:m}=l,[p]=b.useForm(),[u,h]=r.useState(!1);let j;n[0]!==m?(j=function(e){h(!0);const r=c.getState().user.token;d({url:a.addUser,token:r,data:e}).then((e=>{200===e.code&&(i.hide(o),m&&m())})).finally((()=>{h(!1)}))},n[0]=m,n[1]=j):j=n[1];const f=j;let x,y,w,_,k,T,S;return n[2]===Symbol.for("react.memo_cache_sentinel")?(x={flex:"82px"},n[2]=x):x=n[2],n[3]===Symbol.for("react.memo_cache_sentinel")?(y=t.jsx(b.Item,{name:"username",label:"用户名",required:!0,rules:[{validator:(e,r)=>""!==r&&r?/^[a-zA-Z]/.test(r)?/^[a-zA-Z][a-zA-Z0-9_-]*$/.test(r)?r.length<3||r.length>20?Promise.reject(new Error("用户名长度必须在3到20位之间")):Promise.resolve():Promise.reject(new Error("用户名只能包含字母、数字、下划线或短横线")):Promise.reject(new Error("用户名必须以字母开头")):Promise.reject(new Error("请输入用户名"))}],children:t.jsx(g,{placeholder:"用户名",allowClear:!0,maxLength:20})}),n[3]=y):y=n[3],n[4]===Symbol.for("react.memo_cache_sentinel")?(w=t.jsx(b.Item,{label:"密码",name:"password",required:!0,rules:[{validator:(e,r)=>""!==r&&r?/^[a-zA-Z0-9_\-!@#$%^&*()+={}[\]:;"'<>.,?/~`|]+$/.test(r)?r.length<6||r.length>32?Promise.reject(new Error("密码长度必须在6到32位之间")):Promise.resolve():Promise.reject(new Error("密码只能包含字母、数字、下划线、短横线以及其他常用特殊字符")):Promise.reject(new Error("请输入密码"))}],children:t.jsx(g.Password,{autoComplete:"new-password",placeholder:"密码",allowClear:!0,maxLength:32})}),n[4]=w):w=n[4],n[5]===Symbol.for("react.memo_cache_sentinel")?(_=t.jsx(b.Item,{label:"邮箱",name:"email",rules:[{validator(e,r){if(!r)return Promise.resolve();return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(r)?Promise.resolve():Promise.reject(new Error("请输入有效的邮箱地址"))}}],children:t.jsx(g,{placeholder:"邮箱",allowClear:!0})}),n[5]=_):_=n[5],n[6]===Symbol.for("react.memo_cache_sentinel")?(k=t.jsx(s,{onClick:L,children:"取消"}),n[6]=k):k=n[6],n[7]!==u?(T=t.jsxs("div",{className:"flex justify-end gap-3 flex-wrap",children:[k,t.jsx(s,{type:"primary",htmlType:"submit",loading:u,children:"新增用户"})]}),n[7]=u,n[8]=T):T=n[8],n[9]!==p||n[10]!==f||n[11]!==T?(S=t.jsx(t.Fragment,{children:t.jsxs(b,{form:p,autoComplete:"off",variant:"filled",labelCol:x,onFinish:f,children:[y,w,_,T]})}),n[9]=p,n[10]=f,n[11]=T,n[12]=S):S=n[12],S},Z=r.memo((l=>{const i=e.c(35),{record:o,refresh:n}=l;let m;i[0]===Symbol.for("react.memo_cache_sentinel")?(m=[],i[0]=m):m=i[0];const[h,j]=r.useState(m);let f;i[1]!==o.userId||i[2]!==o.userType||i[3]!==n?(f=function(e){p(e,j);const r=c.getState().user.token;setTimeout((()=>{d({url:a.setUserType,token:r,data:{userId:o.userId,type:1===o.userType?0:1}}).then((e=>{200===e.code&&n()})).finally((()=>{u(e,j)}))}),500)},i[1]=o.userId,i[2]=o.userType,i[3]=n,i[4]=f):f=i[4];const x=f;let y;i[5]!==o.userId||i[6]!==n?(y=function(){p(2,j);const e=c.getState().user.token;setTimeout((()=>{d({url:a.deleteUser,token:e,data:{userId:o.userId}}).then((e=>{200===e.code&&n()})).finally((()=>{u(2,j)}))}),500)},i[5]=o.userId,i[6]=n,i[7]=y):y=i[7];const _=y,b=0===o.userType?"是否设为管理员？":"是否取消管理员？";let g;i[8]!==x||i[9]!==o.userType?(g=()=>{x(0===o.userType?0:1)},i[8]=x,i[9]=o.userType,i[10]=g):g=i[10];const k=1===o.userType;let T,S,C,v,A,P,z,F,E;return i[11]===Symbol.for("react.memo_cache_sentinel")?(T={width:"86px"},i[11]=T):T=i[11],i[12]!==h[0]||i[13]!==o.userType?(S=h[0]?t.jsx(w,{}):0===o.userType?"设为管理员":"取消管理员",i[12]=h[0],i[13]=o.userType,i[14]=S):S=i[14],i[15]!==h[0]||i[16]!==k||i[17]!==S?(C=t.jsx(s,{danger:k,type:"link",size:"small",disabled:h[0],style:T,children:S}),i[15]=h[0],i[16]=k,i[17]=S,i[18]=C):C=i[18],i[19]!==b||i[20]!==g||i[21]!==C?(v=t.jsx(I,{title:b,onConfirm:g,children:C}),i[19]=b,i[20]=g,i[21]=C,i[22]=v):v=i[22],i[23]===Symbol.for("react.memo_cache_sentinel")?(A={root:{maxWidth:"200px"}},i[23]=A):A=i[23],i[24]!==h[2]?(P=h[2]?t.jsx(w,{}):"注销",i[24]=h[2],i[25]=P):P=i[25],i[26]!==h[2]||i[27]!==P?(z=t.jsx(s,{danger:!0,type:"link",size:"small",disabled:h[2],children:P}),i[26]=h[2],i[27]=P,i[28]=z):z=i[28],i[29]!==_||i[30]!==z?(F=t.jsx(I,{title:"是否确认注销用户？将清空用户所有数据！",onConfirm:_,styles:A,children:z}),i[29]=_,i[30]=z,i[31]=F):F=i[31],i[32]!==F||i[33]!==v?(E=t.jsxs("div",{className:"flex flex-wrap",children:[v,F]}),i[32]=F,i[33]=v,i[34]=E):E=i[34],E}));function L(){i.hide(o)}export{v as default};
