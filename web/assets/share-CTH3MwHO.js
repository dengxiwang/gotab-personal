const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/shareSay-CtLyUKfp.js","assets/requestIdleCallbackPolyfill-CT2Uunzs.js","assets/requestIdleCallbackPolyfill-DYBeGmCH.css","assets/markdownContent-DKaANkEm.js"])))=>i.map(i=>d[i]);
import{P as e,_ as t}from"./main-DyIzdR1k.js";import{e as s,I as a,x as i,ac as n,j as r,ag as l,ah as o,a8 as c,ax as d,B as m,ai as p,H as u,af as h,aj as j,ab as f,w as x,d as y,T as g,D as b,z as S,aC as _,y as C,at as v}from"./requestIdleCallbackPolyfill-CT2Uunzs.js";import{e as k}from"./assets-CmvcfQKP.js";import{N as w}from"./noPermissions-Dpph3RXw.js";import{F as I}from"./fullSpin-CMzDY22s.js";import{M as O}from"./myDrawer2-iF1A1uRW.js";import{u as D,F as N}from"./index-B5l_nge6.js";import{I as L}from"./index-Dgw5cqVQ.js";import{S as P}from"./index-C1J7OQZZ.js";import{E as T}from"./index-CqFaBIF0.js";import U from"./markdownContent-DKaANkEm.js";import{R as A}from"./QuestionCircleOutlined-B3JZlZLh.js";import{D as F,R,a as E}from"./homePage-CPkYzAIA.js";import{T as H}from"./index-f4najWpg.js";import{R as M,a as Y}from"./MailOutlined-G-2gGlXX.js";import{C as B,S as z}from"./SyncOutlined-Bty6z6Gu.js";import{e as V}from"./spinLoading-BQ24hHPf.js";import{R as $}from"./sortableJsUtils-DiwKAPm-.js";import{R as q,a as Q}from"./PlusOutlined-Dj0OF-5p.js";import"./StepBackwardOutlined-DpwJRxU8.js";import"./index-BbIXSvcQ.js";import"./LeftOutlined-D9Sp279J.js";import"./index-kmb97xVR.js";import"./handleButton-BzvPHsum.js";import"./row-DFvObsCi.js";import"./useBreakpoint-DKl-R_5q.js";import"./mediaQueryUtil-DPPPwwPM.js";import"./QuestionCircleOutlined-DSm95oJP.js";import"./getAllowClear-BfnEnRnP.js";import"./Input-BiSwrENd.js";import"./TextArea-CCBBim-V.js";import"./Overflow-Dd87tN43.js";import"./myModal-CU31-YKH.js";import"./submitForInclusion-3cpvnZJS.js";import"./CloudUploadOutlined-BzSjj2jW.js";import"./ColorPicker-CnMhCakY.js";import"./index-C3_RJzSL.js";import"./index-mdGFZ7v4.js";import"./iconBase-NTOjfvNr.js";import"./SearchOutlined-CCB0jfzY.js";import"./useFresh-CGeh22C4.js";import"./LikeFilled-DQDJchgU.js";import"./index-C2t7G4dJ.js";import"./ReloadOutlined-B00s2TmV.js";import"./LeftOutlined-CdS_kG-p.js";import"./styleChecker-Cxx79Q8k.js";import"./sortable.esm-BbtDOPOV.js";import"./addRecommendAppForm-BrRJR8Yk.js";import"./UserOutlined-HtHoo4Ia.js";import"./index-BO_K7c5l.js";function J(){return J=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},J.apply(this,arguments)}const G=(e,t)=>s.createElement(a,J({},e,{ref:t,icon:B})),K=s.forwardRef(G);function W(){return W=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},W.apply(this,arguments)}const X=(e,t)=>s.createElement(a,W({},e,{ref:t,icon:z})),Z=s.forwardRef(X);function ee(){c.hide(d)}function te(e){return{label:e.label,value:e.id}}function se(e){return e.user.token}function ae(e){return e.appData.listData}const ie=s.memo((function(e){const t=i.c(37),[a]=D(),{type:p,initialValues:u,setShareSettingData:h,setHasShare:j}=e,f=n(ae),x=n(se),[y,g]=s.useState(!1);let b;t[0]!==h||t[1]!==x?(b=function(e){g(!0),e.privateCategoryIds&&(e.privateCategoryIds=e.privateCategoryIds.join(",")),l({url:o.editShareSetting,data:e,token:x}).then((e=>{200===e.code&&e.data&&(h&&h(e.data),c.hide(d))})).finally((()=>{g(!1)}))},t[0]=h,t[1]=x,t[2]=b):b=t[2];const S=b;let _;t[3]!==j||t[4]!==h||t[5]!==x?(_=function(e){g(!0),e.privateCategoryIds&&(e.privateCategoryIds=e.privateCategoryIds.join(",")),l({url:o.addShareSetting,data:e,token:x}).then((e=>{200===e.code&&e.data&&(h&&h(e.data),j&&j(!0),c.hide(d))})).finally((()=>{g(!1)}))},t[3]=j,t[4]=h,t[5]=x,t[6]=_):_=t[6];const C=_;let v;t[7]!==a||t[8]!==u||t[9]!==f?(v=function(){if(!u||!u.privateCategoryIds)return;const e=[];u.privateCategoryIds.forEach((t=>{const s=f.find((e=>e.id===t));s&&e.push(s.id)})),a.setFieldValue("privateCategoryIds",e)},t[7]=a,t[8]=u,t[9]=f,t[10]=v):v=t[10];const k=v;let w,I,O,T,U,A,F,R,E,H,M;t[11]!==k?(w=()=>{k()},t[11]=k,t[12]=w):w=t[12],t[13]===Symbol.for("react.memo_cache_sentinel")?(I=[],t[13]=I):I=t[13],s.useEffect(w,I),t[14]===Symbol.for("react.memo_cache_sentinel")?(O={flex:"72px"},t[14]=O):O=t[14],t[15]!==C||t[16]!==S||t[17]!==p?(T=e=>{"edit"===p?S(e):C(e)},t[15]=C,t[16]=S,t[17]=p,t[18]=T):T=t[18],t[19]===Symbol.for("react.memo_cache_sentinel")?(U=[{validator:(e,t)=>t&&""!==t?t&&!/^[a-zA-Z0-9]+$/.test(t)?Promise.reject("分享码仅限数字和英文"):Promise.resolve():Promise.reject("请输入分享码")}],t[19]=U):U=t[19],t[20]===Symbol.for("react.memo_cache_sentinel")?(A=r.jsx(N.Item,{label:"分享码",required:!0,rules:U,name:"path",children:r.jsx(L,{placeholder:"分享码",allowClear:!0,maxLength:50})}),t[20]=A):A=t[20],t[21]===Symbol.for("react.memo_cache_sentinel")?(F=r.jsx(N.Item,{name:"title",label:"标题名称",children:r.jsx(L,{placeholder:"分享页标题",allowClear:!0,maxLength:50})}),t[21]=F):F=t[21],t[22]===Symbol.for("react.memo_cache_sentinel")?(R=r.jsx(N.Item,{name:"description",label:"描述简介",children:r.jsx(L,{placeholder:"分享页描述",allowClear:!0,maxLength:200})}),t[22]=R):R=t[22],t[23]!==f?(E=f.map(te),t[23]=f,t[24]=E):E=t[24],t[25]!==E?(H=r.jsx(N.Item,{name:"privateCategoryIds",label:"私有分类",children:r.jsx(P,{mode:"multiple",placeholder:"私有分类，分享时隐藏",options:E,allowClear:!0})}),t[25]=E,t[26]=H):H=t[26],t[27]===Symbol.for("react.memo_cache_sentinel")?(M=r.jsx(m,{onClick:ee,children:"取消"}),t[27]=M):M=t[27];const Y="edit"===p?"保存":"创建";let B,z;return t[28]!==y||t[29]!==Y?(B=r.jsxs("div",{className:"flex justify-end gap-3 flex-wrap",children:[M,r.jsx(m,{loading:y,htmlType:"submit",type:"primary",children:Y})]}),t[28]=y,t[29]=Y,t[30]=B):B=t[30],t[31]!==a||t[32]!==u||t[33]!==H||t[34]!==B||t[35]!==T?(z=r.jsx(r.Fragment,{children:r.jsxs(N,{form:a,initialValues:u,autoComplete:"off",labelCol:O,onFinish:T,children:[A,F,R,H,B]})}),t[31]=a,t[32]=u,t[33]=H,t[34]=B,t[35]=T,t[36]=z):z=t[36],z}));function ne(){c.hide(d)}function re(e){return r.jsx(U,{content:e,replace:!1})}function le(e){return e.user.token}const oe=s.memo((function(t){const a=i.c(34),{shareSettingData:f,setShareSettingData:x}=t,[y,g]=s.useState(f.share_say),b=n(le);let S;a[0]===Symbol.for("react.memo_cache_sentinel")?(S=[],a[0]=S):S=a[0];const[_,C]=s.useState(S);let v;a[1]!==b?(v=function(e){return new Promise((t=>{l({url:o.uploadImage,token:b,data:p({file:e})}).then((e=>{200===e.code&&e.data&&t(e.data.image_url)}))}))},a[1]=b,a[2]=v):v=a[2];const k=v;let w;a[3]!==y||a[4]!==x||a[5]!==f||a[6]!==b?(w=function(){y?(h(0,C),l({url:o.editShareSay,data:{shareSay:y},token:b}).then((e=>{200===e.code&&(x&&x({...f,share_say:y}),c.hide(d))})).finally((()=>{j(0,C)}))):u.error("请输入分享有话的内容")},a[3]=y,a[4]=x,a[5]=f,a[6]=b,a[7]=w):w=a[7];const I=w;let O;a[8]!==x||a[9]!==f||a[10]!==b?(O=function(){h(1,C),l({url:o.resetShareSay,token:b}).then((e=>{200===e.code&&x&&(x({...f,share_say:""}),g(""))})).finally((()=>{j(1,C)}))},a[8]=x,a[9]=f,a[10]=b,a[11]=O):O=a[11];const D=O;let N,L,P,U,A,F,R,E,H,M;return a[12]===Symbol.for("react.memo_cache_sentinel")?(N={height:"calc(100% - 44px)"},L=e=>{g(e.text)},a[12]=N,a[13]=L):(N=a[12],L=a[13]),a[14]!==k||a[15]!==y?(P=r.jsx(T,{className:"flex-1",style:N,onChange:L,value:y,renderHTML:re,onImageUpload:k}),a[14]=k,a[15]=y,a[16]=P):P=a[16],a[17]!==_[1]?(U=r.jsx(m,{danger:!0,loading:_[1],children:"重置"}),a[17]=_[1],a[18]=U):U=a[18],a[19]!==D||a[20]!==U?(A=r.jsx(e,{title:"是否确认重置？",onConfirm:D,children:U}),a[19]=D,a[20]=U,a[21]=A):A=a[21],a[22]===Symbol.for("react.memo_cache_sentinel")?(F=r.jsx(m,{onClick:ne,children:"取消"}),a[22]=F):F=a[22],a[23]!==I?(R=()=>{I()},a[23]=I,a[24]=R):R=a[24],a[25]!==_[0]||a[26]!==R?(E=r.jsx(m,{loading:_[0],type:"primary",onClick:R,children:"保存"}),a[25]=_[0],a[26]=R,a[27]=E):E=a[27],a[28]!==E||a[29]!==A?(H=r.jsxs("div",{className:"flex justify-end gap-3 flex-wrap",children:[A,F,E]}),a[28]=E,a[29]=A,a[30]=H):H=a[30],a[31]!==H||a[32]!==P?(M=r.jsxs("div",{className:"flex flex-col gap-3 h-full",children:[P,H]}),a[31]=H,a[32]=P,a[33]=M):M=a[33],M})),ce=S.lazy((()=>t((()=>import("./shareSay-CtLyUKfp.js")),__vite__mapDeps([0,1,2,3]))));function de(){const t=i.c(28),{token:a}=f.useToken(),p=n(ue);let u;t[0]===Symbol.for("react.memo_cache_sentinel")?(u=[],t[0]=u):u=t[0];const[S,D]=s.useState(u),N=n(pe),L=n(me);let P;t[1]===Symbol.for("react.memo_cache_sentinel")?(P={path:"",title:"",description:"",CreatedAt:"",status:0,share_say:"",private_category_ids:"",UpdatedAt:""},t[1]=P):P=t[1];const[T,U]=s.useState(P),[B,z]=s.useState(!1);let J;t[2]!==p?(J=function(){p&&(h(0,D),v({url:o.getUserShare,token:p}).then((e=>{200===e.code&&e.data?(U(e.data),z(!0)):z(!1)})).finally((()=>{j(0,D)})))},t[2]=p,t[3]=J):J=t[3];const G=J;let W,X,ee;t[4]!==G?(W=()=>{G()},t[4]=G,t[5]=W):W=t[5],t[6]===Symbol.for("react.memo_cache_sentinel")?(X=[],t[6]=X):X=t[6],s.useLayoutEffect(W,X),t[7]!==T||t[8]!==p?(ee=function(){h(1,D),l({url:o.enableShare,token:p}).then((e=>{200===e.code&&U({...T,status:1})})).finally((()=>{j(1,D)}))},t[7]=T,t[8]=p,t[9]=ee):ee=t[9];const te=ee;let se;t[10]!==T||t[11]!==p?(se=function(){h(2,D),l({url:o.disableShare,token:p}).then((e=>{200===e.code&&U({...T,status:2})})).finally((()=>{j(2,D)}))},t[10]=T,t[11]=p,t[12]=se):se=t[12];const ae=se;let ne;t[13]!==p?(ne=function(){h(3,D),l({url:o.deleteShare,token:p}).then((e=>{200===e.code&&(U({path:"",title:"",description:"",CreatedAt:"",status:0,share_say:"",private_category_ids:"",UpdatedAt:""}),z(!1))})).finally((()=>{j(3,D)}))},t[13]=p,t[14]=ne):ne=t[14];const re=ne;let le;t[15]!==N?(le=function(e){if(!e)return;const t=e.split(","),s=[];return t.forEach((e=>{const t=N.find((t=>t.id===e));t&&s.push(t.label)})),s.join("，")},t[15]=N,t[16]=le):le=t[16];const de=le;let he;return t[17]!==L||t[18]!==re||t[19]!==ae||t[20]!==te||t[21]!==de||t[22]!==B||t[23]!==S||t[24]!==T||t[25]!==a||t[26]!==p?(he=p?S[0]?r.jsx(I,{}):B?r.jsxs(r.Fragment,{children:[r.jsx(x,{message:"分享有话是以弱化提醒的方式展示在分享页的右上角抽屉中，支持自主自定义markdown显示内容！",banner:!0,type:"info",icon:r.jsx(A,{}),className:"mb-5 rounded-md"}),r.jsx(F,{bordered:!0,column:1,className:"w-full",styles:{label:{padding:"8px 16px"},content:{padding:"8px 16px",textAlign:"end"}},items:[{label:"分享状态",children:r.jsx(g,{title:0===T.status?"请联系管理员或耐心等待审核通过":1===T.status?"您的分享页可正常访问":2===T.status?"您的分享页已暂停分享":3===T.status?"您的分享页因违规已被禁用":"",children:r.jsx(H,{className:"m-0 cursor-pointer",icon:r.jsx(A,{}),color:0===T.status?"default":1===T.status?"green":2===T.status?"orange":"red",children:0===T.status?"待审核":1===T.status?"正常":2===T.status?"已停用":"被禁用"})})},{label:"分享路径",children:(null==T?void 0:T.path)?r.jsx("div",{className:"flex justify-end",children:r.jsx(m,{icon:r.jsx(M,{}),onClick:()=>{window.open(b+"/s/"+(null==T?void 0:T.path))},type:"link",size:"small",className:"h-[22px] p-0",children:b+"/s/"+(null==T?void 0:T.path)||"-"})}):"-"},{label:"私有分类",children:T.private_category_ids?de(T.private_category_ids):"-"},{label:"分享页标题",children:(null==T?void 0:T.title)||"-"},{label:"分享页描述",children:(null==T?void 0:T.description)||"-"},{label:"分享有话",children:T.share_say?r.jsx("div",{className:"flex justify-end",children:r.jsx(m,{disabled:3===T.status,onClick:()=>{c.show(O,{title:"分享有话",backgroundOpacity:L?.92:void 0,children:r.jsx(s.Suspense,{children:r.jsx(ce,{content:T.share_say||""})}),placement:"right",onClosedUseTabListen:!1})},type:"link",className:"p-0 h-[22px]",size:"small",icon:r.jsx(R,{}),children:"预览"})}):"-"},{label:"创建时间",children:y(null==T?void 0:T.CreatedAt).format("YYYY-MM-DD HH:mm:ss")||"-"},{label:"更新时间",children:y(null==T?void 0:T.UpdatedAt).format("YYYY-MM-DD HH:mm:ss")||"-"}]}),3===T.status?null:r.jsxs("div",{className:"flex flex-col mt-3 gap-3",children:[r.jsxs("div",{className:"flex gap-1 font-medium pl-2",style:{color:a.colorTextDescription},children:[r.jsx(K,{}),r.jsx("p",{children:"控制台"})]}),r.jsx(m,{onClick:()=>{const e=""+(b+"/s/"+(null==T?void 0:T.path)),t=null==T?void 0:T.title,s=null==T?void 0:T.description;_(`我的个性分享页：${e}${t?"（"+t+"）":""}${s?"，主要内容："+s:""}`)},icon:r.jsx(E,{}),children:"复制文案"}),r.jsx(m,{icon:r.jsx(Y,{}),onClick:()=>{c.show(d,{title:"有话设置",width:"860px",height:"520px",children:r.jsx(oe,{shareSettingData:T,setShareSettingData:U}),onClosedUseTabListen:!1})},children:"有话设置"}),r.jsx(m,{icon:r.jsx(V,{}),onClick:()=>{c.show(d,{title:"编辑分享信息",children:r.jsx(ie,{type:"edit",initialValues:{path:T.path,title:T.title,description:T.description,privateCategoryIds:T.private_category_ids.split(",")},setShareSettingData:U}),onClosedUseTabListen:!1})},children:"编辑信息"}),1===T.status?r.jsx(m,{onClick:ae,loading:S[2],icon:r.jsx($,{}),children:"暂停分享"}):2===T.status?r.jsx(m,{onClick:te,loading:S[1],icon:r.jsx(Z,{}),children:"启用分享"}):null,r.jsx(e,{title:"是否确认删除？",onConfirm:re,children:r.jsx(m,{danger:!0,icon:r.jsx(q,{}),loading:S[3],children:"删除分享"})})]})]}):r.jsx(r.Fragment,{children:r.jsx(C,{className:"flex flex-col items-center w-full px-0",icon:r.jsx("div",{className:"h-[240px]",children:r.jsx("img",{alt:"",src:k,style:{width:"auto",height:"240px"}})}),title:r.jsx("div",{className:"flex justify-center w-full",children:r.jsx(m,{onClick:()=>{c.show(d,{title:"创建分享页",children:r.jsx(ie,{type:"add",setShareSettingData:U,setHasShare:z}),onClosedUseTabListen:!1})},icon:r.jsx(Q,{}),type:"primary",children:"创建分享页"})})})}):r.jsx(w,{title:"权限不足",subTitle:"请您先完成登录/注册",extra:!1}),t[17]=L,t[18]=re,t[19]=ae,t[20]=te,t[21]=de,t[22]=B,t[23]=S,t[24]=T,t[25]=a,t[26]=p,t[27]=he):he=t[27],he}function me(e){return e.card.bgBackdropFilter}function pe(e){return e.appData.listData}function ue(e){return e.user.token}export{de as default};
