import{c as e,r as t,j as n,h as a,B as o,l as s,O as r,o as l,v as c,n as i,q as u}from"./main-BznldwrR.js";import{E as m}from"./index-DJLWfzu8.js";import d from"./markdownContent-_QQqxXX2.js";import{C as f}from"./contentLayout-CRmsUyuP.js";import{S as p}from"./index-DncNCKRz.js";import{S as x}from"./index-DJHRXG-n.js";function b(){const a=e.c(3),[o,s]=t.useState("aboutUs");let r,l;return a[0]===Symbol.for("react.memo_cache_sentinel")?(r=n.jsx(p,{options:[{label:"关于我们",value:"aboutUs"},{label:"捐赠打赏",value:"donate"}],onChange:e=>{s(e)},className:"mb-3"}),a[0]=r):r=a[0],a[1]!==o?(l=n.jsxs(f,{children:[r,n.jsx(h,{type:o})]}),a[1]=o,a[2]=l):l=a[2],l}const h=d=>{const f=e.c(29),{type:p}=d,[b,h]=t.useState("");let y;f[0]===Symbol.for("react.memo_cache_sentinel")?(y=[],f[0]=y):y=f[0];const[C,S]=t.useState(y),U=a(j);let _;f[1]===Symbol.for("react.memo_cache_sentinel")?(_=new AbortController,f[1]=_):_=f[1];const w=t.useRef(_);let k;f[2]!==U||f[3]!==p?(k=function(){w.current.abort(),w.current=new AbortController,s(0,S),r({url:"aboutUs"===p?l.getAboutUsContent:l.getDonateContent,token:U,signal:w.current.signal}).then(e=>{200===e.code&&("aboutUs"===p?h(e.data.aboutUs):"donate"===p&&h(e.data.donate))}).finally(()=>{c(0,S)})},f[2]=U,f[3]=p,f[4]=k):k=f[4];const v=k;let N,A,D;f[5]!==v?(N=()=>{v()},f[5]=v,f[6]=N):N=f[6],f[7]!==p?(A=[p],f[7]=p,f[8]=A):A=f[8],t.useEffect(N,A),f[9]!==U?(D=function(e){return new Promise(t=>{i({url:l.uploadImage,token:U,data:u({file:e})}).then(e=>{200===e.code&&e.data&&t(e.data.image_url)})})},f[9]=U,f[10]=D):D=f[10];const E=D;let I;f[11]!==b||f[12]!==U||f[13]!==p?(I=function(){s(1,S),i({url:"aboutUs"===p?l.updateAboutUsContent:l.updateDonateContent,token:U,data:{content:b}}).finally(()=>{c(1,S)})},f[11]=b,f[12]=U,f[13]=p,f[14]=I):I=f[14];const L=I;let O,T,q,z,B,H;return f[15]===Symbol.for("react.memo_cache_sentinel")?(O={height:"calc(100% - 44px)"},T=e=>{h(e.text)},f[15]=O,f[16]=T):(O=f[15],T=f[16]),f[17]!==E||f[18]!==b?(q=n.jsx(m,{className:"flex-1",style:O,onChange:T,value:b,renderHTML:g,onImageUpload:E}),f[17]=E,f[18]=b,f[19]=q):q=f[19],f[20]!==C[1]||f[21]!==L?(z=n.jsx("div",{className:"flex justify-end gap-3 flex-wrap mt-3",children:n.jsx(o,{loading:C[1],type:"primary",onClick:L,children:"保存配置"})}),f[20]=C[1],f[21]=L,f[22]=z):z=f[22],f[23]!==z||f[24]!==q?(B=n.jsxs("main",{className:"w-full h-[480px]",children:[q,z]}),f[23]=z,f[24]=q,f[25]=B):B=f[25],f[26]!==C[0]||f[27]!==B?(H=n.jsx(x,{size:"large",spinning:C[0],wrapperClassName:"w-full",children:B}),f[26]=C[0],f[27]=B,f[28]=H):H=f[28],H};function j(e){return e.user.token}function g(e){return n.jsx(d,{content:e,replace:!1})}export{b as default};
