const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/shareSay-B9bjQ8h7.js","assets/requestIdleCallbackPolyfill-DuXR6Mmk.js","assets/requestIdleCallbackPolyfill-CVdPGmD0.css","assets/markdownContent-fUeTi6R3.js"])))=>i.map(i=>d[i]);
import{r as e,I as t,c as s,h as a,j as i,n,o as l,$ as r,a0 as o,B as c,q as d,m,l as p,v as u,Z as h,t as j,Q as f,d as x,w as y,aS as g,W as b,a5 as S,i as _,_ as v,O as C}from"./requestIdleCallbackPolyfill-DuXR6Mmk.js";import{e as k}from"./assets-B8Bi78Vh.js";import{N as w}from"./noPermissions-CwFgmgO8.js";import{F as O}from"./fullSpin-Bu9E-UgA.js";import{M as I}from"./myDrawer2-tklTaCYh.js";import{u as D,F as N}from"./index-BMudaHuW.js";import{I as L}from"./index-BrsrGf5j.js";import{S as U}from"./index-COg7AUHb.js";import{E as T}from"./index-cirGW_tn.js";import A from"./markdownContent-fUeTi6R3.js";import{R as F}from"./QuestionCircleOutlined-BiPPkPpK.js";import{D as P,R}from"./sortableJsUtils-DI3fcbTj.js";import{T as E}from"./index-CBlsidtm.js";import{R as Y,a as M}from"./MailOutlined-kR6rLhHd.js";import{R as H,a as B}from"./homePage-BMwq1FXb.js";import{C as Q,S as V}from"./SyncOutlined-Bty6z6Gu.js";import{e as $}from"./spinLoading-B6-A3G_X.js";import{R as q,a as z}from"./PlusOutlined-BYc4BpPG.js";import"./StepBackwardOutlined-DpwJRxU8.js";import"./index-mmVZs6--.js";import"./LeftOutlined-D9Sp279J.js";import"./index-BR_vpJNT.js";import"./handleButton-Cvl2vIli.js";import"./row-BxBkKylz.js";import"./useBreakpoint-BLWHdwqk.js";import"./mediaQueryUtil-DPPPwwPM.js";import"./QuestionCircleOutlined-DSm95oJP.js";import"./getAllowClear-BFzTGu2W.js";import"./Input-DeCKxNbM.js";import"./TextArea-Cr0GXhmp.js";import"./Overflow-BhMs7XL1.js";import"./myModal-BvN7GT0N.js";import"./submitForInclusion-_XyO0pW_.js";import"./CloudUploadOutlined-Clxird1Z.js";import"./ColorPicker-Byf6q6el.js";import"./index-CqnYxUI_.js";import"./index-CsFfv6FV.js";import"./iconBase-DcT7EL5-.js";import"./SearchOutlined-CzyPD-25.js";import"./useFresh-Do_Ws6bQ.js";import"./index-ffXlViMr.js";import"./LikeFilled-BjB1_RYz.js";import"./ReloadOutlined-B00s2TmV.js";import"./LeftOutlined-DDnMjEWA.js";import"./styleChecker-Dktf464x.js";import"./sortable.esm-BbtDOPOV.js";import"./addRecommendAppForm-GN59AeeH.js";import"./UserOutlined-CwFVHM6E.js";import"./index-CeCo6Hjn.js";function Z(){return Z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Z.apply(this,arguments)}const J=(s,a)=>e.createElement(t,Z({},s,{ref:a,icon:Q})),K=e.forwardRef(J);function W(){return W=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},W.apply(this,arguments)}const X=(s,a)=>e.createElement(t,W({},s,{ref:a,icon:V})),G=e.forwardRef(X);function ee(){r.hide(o)}function te(e){return{label:e.label,value:e.id}}function se(e){return e.user.token}function ae(e){return e.appData.listData}const ie=e.memo((function(t){const d=s.c(37),[m]=D(),{type:p,initialValues:u,setShareSettingData:h,setHasShare:j}=t,f=a(ae),x=a(se),[y,g]=e.useState(!1);let b;d[0]!==h||d[1]!==x?(b=function(e){g(!0),e.privateCategoryIds&&(e.privateCategoryIds=e.privateCategoryIds.join(",")),n({url:l.editShareSetting,data:e,token:x}).then((e=>{200===e.code&&e.data&&(h&&h(e.data),r.hide(o))})).finally((()=>{g(!1)}))},d[0]=h,d[1]=x,d[2]=b):b=d[2];const S=b;let _;d[3]!==j||d[4]!==h||d[5]!==x?(_=function(e){g(!0),e.privateCategoryIds&&(e.privateCategoryIds=e.privateCategoryIds.join(",")),n({url:l.addShareSetting,data:e,token:x}).then((e=>{200===e.code&&e.data&&(h&&h(e.data),j&&j(!0),r.hide(o))})).finally((()=>{g(!1)}))},d[3]=j,d[4]=h,d[5]=x,d[6]=_):_=d[6];const v=_;let C;d[7]!==m||d[8]!==u||d[9]!==f?(C=function(){if(!u||!u.privateCategoryIds)return;const e=[];u.privateCategoryIds.forEach((t=>{const s=f.find((e=>e.id===t));s&&e.push(s.id)})),m.setFieldValue("privateCategoryIds",e)},d[7]=m,d[8]=u,d[9]=f,d[10]=C):C=d[10];const k=C;let w,O,I,T,A,F,P,R,E,Y,M;d[11]!==k?(w=()=>{k()},d[11]=k,d[12]=w):w=d[12],d[13]===Symbol.for("react.memo_cache_sentinel")?(O=[],d[13]=O):O=d[13],e.useEffect(w,O),d[14]===Symbol.for("react.memo_cache_sentinel")?(I={flex:"72px"},d[14]=I):I=d[14],d[15]!==v||d[16]!==S||d[17]!==p?(T=e=>{"edit"===p?S(e):v(e)},d[15]=v,d[16]=S,d[17]=p,d[18]=T):T=d[18],d[19]===Symbol.for("react.memo_cache_sentinel")?(A=[{validator:(e,t)=>t&&""!==t?t&&!/^[a-zA-Z0-9]+$/.test(t)?Promise.reject("分享码仅限数字和英文"):Promise.resolve():Promise.reject("请输入分享码")}],d[19]=A):A=d[19],d[20]===Symbol.for("react.memo_cache_sentinel")?(F=i.jsx(N.Item,{label:"分享码",required:!0,rules:A,name:"path",children:i.jsx(L,{placeholder:"分享码",allowClear:!0,maxLength:50})}),d[20]=F):F=d[20],d[21]===Symbol.for("react.memo_cache_sentinel")?(P=i.jsx(N.Item,{name:"title",label:"标题名称",children:i.jsx(L,{placeholder:"分享页标题",allowClear:!0,maxLength:50})}),d[21]=P):P=d[21],d[22]===Symbol.for("react.memo_cache_sentinel")?(R=i.jsx(N.Item,{name:"description",label:"描述简介",children:i.jsx(L,{placeholder:"分享页描述",allowClear:!0,maxLength:200})}),d[22]=R):R=d[22],d[23]!==f?(E=f.map(te),d[23]=f,d[24]=E):E=d[24],d[25]!==E?(Y=i.jsx(N.Item,{name:"privateCategoryIds",label:"私有分类",children:i.jsx(U,{mode:"multiple",placeholder:"私有分类，分享时隐藏",options:E,allowClear:!0})}),d[25]=E,d[26]=Y):Y=d[26],d[27]===Symbol.for("react.memo_cache_sentinel")?(M=i.jsx(c,{onClick:ee,children:"取消"}),d[27]=M):M=d[27];const H="edit"===p?"保存":"创建";let B,Q;return d[28]!==y||d[29]!==H?(B=i.jsxs("div",{className:"flex justify-end gap-3 flex-wrap",children:[M,i.jsx(c,{loading:y,htmlType:"submit",type:"primary",children:H})]}),d[28]=y,d[29]=H,d[30]=B):B=d[30],d[31]!==m||d[32]!==u||d[33]!==Y||d[34]!==B||d[35]!==T?(Q=i.jsx(i.Fragment,{children:i.jsxs(N,{form:m,initialValues:u,autoComplete:"off",labelCol:I,onFinish:T,children:[F,P,R,Y,B]})}),d[31]=m,d[32]=u,d[33]=Y,d[34]=B,d[35]=T,d[36]=Q):Q=d[36],Q}));function ne(){r.hide(o)}function le(e){return i.jsx(A,{content:e,replace:!1})}function re(e){return e.user.token}const oe=e.memo((function(t){const j=s.c(34),{shareSettingData:f,setShareSettingData:x}=t,[y,g]=e.useState(f.share_say),b=a(re);let S;j[0]===Symbol.for("react.memo_cache_sentinel")?(S=[],j[0]=S):S=j[0];const[_,v]=e.useState(S);let C;j[1]!==b?(C=function(e){return new Promise((t=>{n({url:l.uploadImage,token:b,data:d({file:e})}).then((e=>{200===e.code&&e.data&&t(e.data.image_url)}))}))},j[1]=b,j[2]=C):C=j[2];const k=C;let w;j[3]!==y||j[4]!==x||j[5]!==f||j[6]!==b?(w=function(){y?(p(0,v),n({url:l.editShareSay,data:{shareSay:y},token:b}).then((e=>{200===e.code&&(x&&x({...f,share_say:y}),r.hide(o))})).finally((()=>{u(0,v)}))):m.error("请输入分享有话的内容")},j[3]=y,j[4]=x,j[5]=f,j[6]=b,j[7]=w):w=j[7];const O=w;let I;j[8]!==x||j[9]!==f||j[10]!==b?(I=function(){p(1,v),n({url:l.resetShareSay,token:b}).then((e=>{200===e.code&&x&&(x({...f,share_say:""}),g(""))})).finally((()=>{u(1,v)}))},j[8]=x,j[9]=f,j[10]=b,j[11]=I):I=j[11];const D=I;let N,L,U,A,F,P,R,E,Y,M;return j[12]===Symbol.for("react.memo_cache_sentinel")?(N={height:"calc(100% - 44px)"},L=e=>{g(e.text)},j[12]=N,j[13]=L):(N=j[12],L=j[13]),j[14]!==k||j[15]!==y?(U=i.jsx(T,{className:"flex-1",style:N,onChange:L,value:y,renderHTML:le,onImageUpload:k}),j[14]=k,j[15]=y,j[16]=U):U=j[16],j[17]!==_[1]?(A=i.jsx(c,{danger:!0,loading:_[1],children:"重置"}),j[17]=_[1],j[18]=A):A=j[18],j[19]!==D||j[20]!==A?(F=i.jsx(h,{title:"是否确认重置？",onConfirm:D,children:A}),j[19]=D,j[20]=A,j[21]=F):F=j[21],j[22]===Symbol.for("react.memo_cache_sentinel")?(P=i.jsx(c,{onClick:ne,children:"取消"}),j[22]=P):P=j[22],j[23]!==O?(R=()=>{O()},j[23]=O,j[24]=R):R=j[24],j[25]!==_[0]||j[26]!==R?(E=i.jsx(c,{loading:_[0],type:"primary",onClick:R,children:"保存"}),j[25]=_[0],j[26]=R,j[27]=E):E=j[27],j[28]!==E||j[29]!==F?(Y=i.jsxs("div",{className:"flex justify-end gap-3 flex-wrap",children:[F,P,E]}),j[28]=E,j[29]=F,j[30]=Y):Y=j[30],j[31]!==Y||j[32]!==U?(M=i.jsxs("div",{className:"flex flex-col gap-3 h-full",children:[U,Y]}),j[31]=Y,j[32]=U,j[33]=M):M=j[33],M})),ce=b.lazy((()=>v((()=>import("./shareSay-B9bjQ8h7.js")),__vite__mapDeps([0,1,2,3]))));function de(){const t=s.c(28),{token:d}=j.useToken(),m=a(ue);let b;t[0]===Symbol.for("react.memo_cache_sentinel")?(b=[],t[0]=b):b=t[0];const[v,D]=e.useState(b),N=a(pe),L=a(me);let U;t[1]===Symbol.for("react.memo_cache_sentinel")?(U={path:"",title:"",description:"",CreatedAt:"",status:0,share_say:"",private_category_ids:"",UpdatedAt:""},t[1]=U):U=t[1];const[T,A]=e.useState(U),[Q,V]=e.useState(!1);let Z;t[2]!==m?(Z=function(){m&&(p(0,D),C({url:l.getUserShare,token:m}).then((e=>{200===e.code&&e.data?(A(e.data),V(!0)):V(!1)})).finally((()=>{u(0,D)})))},t[2]=m,t[3]=Z):Z=t[3];const J=Z;let W,X,ee;t[4]!==J?(W=()=>{J()},t[4]=J,t[5]=W):W=t[5],t[6]===Symbol.for("react.memo_cache_sentinel")?(X=[],t[6]=X):X=t[6],e.useLayoutEffect(W,X),t[7]!==T||t[8]!==m?(ee=function(){p(1,D),n({url:l.enableShare,token:m}).then((e=>{200===e.code&&A({...T,status:1})})).finally((()=>{u(1,D)}))},t[7]=T,t[8]=m,t[9]=ee):ee=t[9];const te=ee;let se;t[10]!==T||t[11]!==m?(se=function(){p(2,D),n({url:l.disableShare,token:m}).then((e=>{200===e.code&&A({...T,status:2})})).finally((()=>{u(2,D)}))},t[10]=T,t[11]=m,t[12]=se):se=t[12];const ae=se;let ne;t[13]!==m?(ne=function(){p(3,D),n({url:l.deleteShare,token:m}).then((e=>{200===e.code&&(A({path:"",title:"",description:"",CreatedAt:"",status:0,share_say:"",private_category_ids:"",UpdatedAt:""}),V(!1))})).finally((()=>{u(3,D)}))},t[13]=m,t[14]=ne):ne=t[14];const le=ne;let re;t[15]!==N?(re=function(e){if(!e)return;const t=e.split(","),s=[];return t.forEach((e=>{const t=N.find((t=>t.id===e));t&&s.push(t.label)})),s.join("，")},t[15]=N,t[16]=re):re=t[16];const de=re;let he;return t[17]!==L||t[18]!==le||t[19]!==ae||t[20]!==te||t[21]!==de||t[22]!==Q||t[23]!==v||t[24]!==T||t[25]!==d||t[26]!==m?(he=m?v[0]?i.jsx(O,{}):Q?i.jsxs(i.Fragment,{children:[i.jsx(f,{message:"分享有话是以弱化提醒的方式展示在分享页的右上角抽屉中，支持自主自定义markdown显示内容！",banner:!0,type:"info",icon:i.jsx(F,{}),className:"mb-5 rounded-md"}),i.jsx(P,{bordered:!0,column:1,className:"w-full",styles:{label:{padding:"8px 16px"},content:{padding:"8px 16px",textAlign:"end"}},items:[{label:"分享状态",children:i.jsx(y,{title:0===T.status?"请联系管理员或耐心等待审核通过":1===T.status?"您的分享页可正常访问":2===T.status?"您的分享页已暂停分享":3===T.status?"您的分享页因违规已被禁用":"",children:i.jsx(E,{className:"m-0 cursor-pointer",icon:i.jsx(F,{}),color:0===T.status?"default":1===T.status?"green":2===T.status?"orange":"red",children:0===T.status?"待审核":1===T.status?"正常":2===T.status?"已停用":"被禁用"})})},{label:"分享路径",children:(null==T?void 0:T.path)?i.jsx("div",{className:"flex justify-end",children:i.jsx(c,{icon:i.jsx(Y,{}),onClick:()=>{window.open(g+"/s/"+(null==T?void 0:T.path))},type:"link",size:"small",className:"h-[22px] p-0",children:g+"/s/"+(null==T?void 0:T.path)||"-"})}):"-"},{label:"私有分类",children:T.private_category_ids?de(T.private_category_ids):"-"},{label:"分享页标题",children:(null==T?void 0:T.title)||"-"},{label:"分享页描述",children:(null==T?void 0:T.description)||"-"},{label:"分享有话",children:T.share_say?i.jsx("div",{className:"flex justify-end",children:i.jsx(c,{disabled:3===T.status,onClick:()=>{r.show(I,{title:"分享有话",backgroundOpacity:L?.92:void 0,children:i.jsx(e.Suspense,{children:i.jsx(ce,{content:T.share_say||""})}),placement:"right",onClosedUseTabListen:!1})},type:"link",className:"p-0 h-[22px]",size:"small",icon:i.jsx(H,{}),children:"预览"})}):"-"},{label:"创建时间",children:x(null==T?void 0:T.CreatedAt).format("YYYY-MM-DD HH:mm:ss")||"-"},{label:"更新时间",children:x(null==T?void 0:T.UpdatedAt).format("YYYY-MM-DD HH:mm:ss")||"-"}]}),3===T.status?null:i.jsxs("div",{className:"flex flex-col mt-3 gap-3",children:[i.jsxs("div",{className:"flex gap-1 font-medium pl-2",style:{color:d.colorTextDescription},children:[i.jsx(K,{}),i.jsx("p",{children:"控制台"})]}),i.jsx(c,{onClick:()=>{const e=""+(g+"/s/"+(null==T?void 0:T.path)),t=null==T?void 0:T.title,s=null==T?void 0:T.description;S(`我的个性分享页：${e}${t?"（"+t+"）":""}${s?"，主要内容："+s:""}`)},icon:i.jsx(B,{}),children:"复制文案"}),i.jsx(c,{icon:i.jsx(M,{}),onClick:()=>{r.show(o,{title:"有话设置",width:"860px",height:"520px",children:i.jsx(oe,{shareSettingData:T,setShareSettingData:A}),onClosedUseTabListen:!1})},children:"有话设置"}),i.jsx(c,{icon:i.jsx($,{}),onClick:()=>{r.show(o,{title:"编辑分享信息",children:i.jsx(ie,{type:"edit",initialValues:{path:T.path,title:T.title,description:T.description,privateCategoryIds:T.private_category_ids.split(",")},setShareSettingData:A}),onClosedUseTabListen:!1})},children:"编辑信息"}),1===T.status?i.jsx(c,{onClick:ae,loading:v[2],icon:i.jsx(R,{}),children:"暂停分享"}):2===T.status?i.jsx(c,{onClick:te,loading:v[1],icon:i.jsx(G,{}),children:"启用分享"}):null,i.jsx(h,{title:"是否确认删除？",onConfirm:le,children:i.jsx(c,{danger:!0,icon:i.jsx(q,{}),loading:v[3],children:"删除分享"})})]})]}):i.jsx(i.Fragment,{children:i.jsx(_,{className:"flex flex-col items-center w-full px-0",icon:i.jsx("div",{className:"h-[240px]",children:i.jsx("img",{alt:"",src:k,style:{width:"auto",height:"240px"}})}),title:i.jsx("div",{className:"flex justify-center w-full",children:i.jsx(c,{onClick:()=>{r.show(o,{title:"创建分享页",children:i.jsx(ie,{type:"add",setShareSettingData:A,setHasShare:V}),onClosedUseTabListen:!1})},icon:i.jsx(z,{}),type:"primary",children:"创建分享页"})})})}):i.jsx(w,{title:"权限不足",subTitle:"请您先完成登录/注册",extra:!1}),t[17]=L,t[18]=le,t[19]=ae,t[20]=te,t[21]=de,t[22]=Q,t[23]=v,t[24]=T,t[25]=d,t[26]=m,t[27]=he):he=t[27],he}function me(e){return e.card.bgBackdropFilter}function pe(e){return e.appData.listData}function ue(e){return e.user.token}export{de as default};
