import{c as e,j as t,r as i,B as s,Q as n,F as o,$ as r,a0 as l,o as a,l as c,a as d,n as m,v as u,a1 as j,a2 as p,Z as f,q as h,m as x}from"./main-BznldwrR.js";import{E as y}from"./index-DJLWfzu8.js";import{u as k}from"./useFresh-BBfhmAj4.js";import{M as b,R as g}from"./myTable-CoesqfYG.js";import{H as _}from"./handleButton-CvdVWmsL.js";import w from"./markdownContent-_QQqxXX2.js";import{C as S}from"./contentLayout-CRmsUyuP.js";import{R as C}from"./ReloadOutlined-CGA5s41u.js";import{R as v}from"./QuestionCircleOutlined-Cbz-ZHDf.js";import{T as N}from"./index-BJB7vPB3.js";import{R as O}from"./UserOutlined-CKr-E0CC.js";import{F as T}from"./index-CM88uxhR.js";import{I}from"./index-CU_E_toA.js";import"./index-B5NmSUX2.js";import"./index-DbTnZT_A.js";import"./LeftOutlined-D9Sp279J.js";import"./MailOutlined-CI-nFNPu.js";import"./Overflow-t0s94lkY.js";import"./mediaQueryUtil-DPPPwwPM.js";import"./index-pOq2t2PQ.js";import"./getAllowClear-Bhk0ADw3.js";import"./Input-MFSIJ5db.js";import"./transformData-W7IqF1wa.js";import"./assets-B8Bi78Vh.js";import"./MoneyCollectOutlined-4U8275jN.js";import"./MoneyCollectOutlined-4QlEwa2l.js";import"./index-DiYt940-.js";import"./styleChecker-CNiLJu-y.js";import"./AlipayOutlined-i_cP3CWs.js";import"./AlipayOutlined-tZM3mGx9.js";import"./useBreakpoint-BajckZld.js";import"./index-DJHRXG-n.js";import"./ReloadOutlined-B00s2TmV.js";import"./QuestionCircleOutlined-DSm95oJP.js";import"./row-CgX7p7wl.js";import"./TextArea-CUVoyy7V.js";function F(){const i=e.c(21),{key:c,refresh:d}=k();let m,u,j,p,f,h;i[0]===Symbol.for("react.memo_cache_sentinel")?(m={title:"创建人",key:"username",width:160,fixed:"left",render:L},u={title:"状态",key:"status",width:80,render:R},j={title:"标题",key:"title",width:200},p={title:"内容",key:"content",width:400},f={type:"time",title:"创建时间",key:"notice_time",width:200},i[0]=m,i[1]=u,i[2]=j,i[3]=p,i[4]=f):(m=i[0],u=i[1],j=i[2],p=i[3],f=i[4]),i[5]!==d?(h=[m,u,j,p,f,{title:"操作",fixed:"right",width:220,render:(e,i)=>t.jsx(M,{record:i,refresh:d})}],i[5]=d,i[6]=h):h=i[6];const x=h;let y,g,_,w,N,O,T;return i[7]===Symbol.for("react.memo_cache_sentinel")?(y=t.jsx(C,{}),i[7]=y):y=i[7],i[8]!==d?(g=t.jsx(s,{type:"primary",icon:y,onClick:()=>{d()},children:"刷新列表"}),i[8]=d,i[9]=g):g=i[9],i[10]===Symbol.for("react.memo_cache_sentinel")?(_=t.jsx(n,{type:"warning",description:t.jsxs(t.Fragment,{children:[t.jsx(v,{className:"mr-1"}),"只会通知最新一条启用的公告！公告新增后需要二次确认是否发布，并且一天只可发布一次公告，以便保证用户体验！"]}),className:"mt-3 p-1 px-3 text-xs font-normal w-full"}),w=t.jsx(o,{className:"my-3"}),i[10]=_,i[11]=w):(_=i[10],w=i[11]),i[12]!==d?(N=t.jsx("div",{className:"mb-3",children:t.jsx(s,{type:"primary",onClick:()=>{r.show(l,{title:"新增公告",children:t.jsx(q,{refresh:d,type:"add"}),width:720})},children:"新增公告"})}),i[12]=d,i[13]=N):N=i[13],i[14]!==x||i[15]!==c?(O=t.jsx(b,{columns:x,getListUrl:a.getNoticeList,dataKey:"data.list",tableKey:c}),i[14]=x,i[15]=c,i[16]=O):O=i[16],i[17]!==N||i[18]!==O||i[19]!==g?(T=t.jsxs(S,{children:[g,_,w,N,O]}),i[17]=N,i[18]=O,i[19]=g,i[20]=T):T=i[20],T}function R(e){return t.jsx(N,{color:0===e?"blue":1===e?"green":"red",children:0===e?"待审核":1===e?"正常":"停用"})}function L(e){return t.jsx(N,{color:e?"geekblue":"red",bordered:!1,icon:t.jsx(O,{}),children:e||"已注销"})}const M=i.memo(n=>{const o=e.c(43),{record:h,refresh:x}=n;let y;o[0]===Symbol.for("react.memo_cache_sentinel")?(y=[],o[0]=y):y=o[0];const[k,b]=i.useState(y);let S;o[1]!==h.id||o[2]!==x?(S=function(){c(0,b);const e=d.getState().user.token;setTimeout(()=>{m({url:a.rejectNotice,token:e,data:{id:h.id}}).then(e=>{200===e.code&&x()}).finally(()=>{u(0,b)})},500)},o[1]=h.id,o[2]=x,o[3]=S):S=o[3];const C=S;let v;o[4]!==h.id||o[5]!==x?(v=function(){c(0,b);const e=d.getState().user.token;setTimeout(()=>{m({url:a.confirmNotice,token:e,data:{id:h.id}}).then(e=>{200===e.code&&x()}).finally(()=>{u(0,b)})},500)},o[4]=h.id,o[5]=x,o[6]=v):v=o[6];const N=v;let O;o[7]!==h.id||o[8]!==x?(O=function(){c(1,b);const e=d.getState().user.token;setTimeout(()=>{m({url:a.deleteNotice,token:e,data:{id:h.id}}).then(e=>{200===e.code&&x()}).finally(()=>{u(1,b)})},500)},o[7]=h.id,o[8]=x,o[9]=O):O=o[9];const T=O;let I;o[10]!==h.content||o[11]!==h.title?(I=function(){j.open({closeIcon:t.jsx("div",{className:"my-handle-icon",children:t.jsx(_,{icon:t.jsx(p,{})})}),message:h.title,description:t.jsx(w,{content:h.content}),duration:null})},o[10]=h.content,o[11]=h.title,o[12]=I):I=o[12];const F=I;let R,L;o[13]!==F?(R=t.jsx(s,{type:"link",size:"small",onClick:F,children:"预览"}),o[13]=F,o[14]=R):R=o[14],o[15]!==h||o[16]!==x?(L=t.jsx(s,{type:"link",size:"small",onClick:()=>{r.show(l,{title:"编辑公告",children:t.jsx(q,{editItem:h,type:"edit",refresh:x}),width:720})},children:"编辑"}),o[15]=h,o[16]=x,o[17]=L):L=o[17];const M=0===h.status||2===h.status?"是否确认发布？":"是否确认停用？",z=0===h.status||2===h.status?N:C;let A,Q,U,B,H,K,P,V,Z;return o[18]===Symbol.for("react.memo_cache_sentinel")?(A={width:"44px"},o[18]=A):A=o[18],o[19]!==k[0]||o[20]!==h.status?(Q=k[0]?t.jsx(g,{}):0===h.status||2===h.status?"发布":"停用",o[19]=k[0],o[20]=h.status,o[21]=Q):Q=o[21],o[22]!==k[0]||o[23]!==Q?(U=t.jsx(s,{type:"link",size:"small",disabled:k[0],style:A,children:Q}),o[22]=k[0],o[23]=Q,o[24]=U):U=o[24],o[25]!==U||o[26]!==M||o[27]!==z?(B=t.jsx(f,{title:M,onConfirm:z,children:U}),o[25]=U,o[26]=M,o[27]=z,o[28]=B):B=o[28],o[29]===Symbol.for("react.memo_cache_sentinel")?(H={width:"44px"},o[29]=H):H=o[29],o[30]!==k[1]?(K=k[1]?t.jsx(g,{}):"删除",o[30]=k[1],o[31]=K):K=o[31],o[32]!==k[1]||o[33]!==K?(P=t.jsx(s,{danger:!0,type:"link",size:"small",disabled:k[1],style:H,children:K}),o[32]=k[1],o[33]=K,o[34]=P):P=o[34],o[35]!==T||o[36]!==P?(V=t.jsx(f,{title:"是否确认删除？",onConfirm:T,children:P}),o[35]=T,o[36]=P,o[37]=V):V=o[37],o[38]!==B||o[39]!==V||o[40]!==R||o[41]!==L?(Z=t.jsxs("div",{className:"flex flex-wrap",children:[R,L,B,V]}),o[38]=B,o[39]=V,o[40]=R,o[41]=L,o[42]=Z):Z=o[42],Z}),q=n=>{const o=e.c(23),{editItem:c,refresh:u,type:j}=n,p=void 0===j?"add":j,[f]=T.useForm(),[k,b]=i.useState(!1),[g,_]=i.useState(null==c?void 0:c.content);let w;o[0]===Symbol.for("react.memo_cache_sentinel")?(w=function(e){const t=d.getState().user.token;return new Promise(i=>{m({url:a.uploadImage,token:t,data:h({file:e})}).then(e=>{200===e.code&&e.data&&i(e.data.image_url)})})},o[0]=w):w=o[0];const S=w;let C;o[1]!==(null==c?void 0:c.id)||o[2]!==g||o[3]!==u||o[4]!==p?(C=function(e){const t=d.getState().user.token;if(!g.trim())return void x.error("请输入公告内容");const i={title:e.title,content:g};b(!0),setTimeout(()=>{m({url:"add"===p?a.addNotice:a.editNotice,token:t,data:"add"===p?i:{id:null==c?void 0:c.id,...i}}).then(e=>{200===e.code&&(u(),r.hide(l))}).finally(()=>{b(!1)})},500)},o[1]=null==c?void 0:c.id,o[2]=g,o[3]=u,o[4]=p,o[5]=C):C=o[5];const v=C;let N,O,F,R,L,M,q;o[6]===Symbol.for("react.memo_cache_sentinel")?(N={flex:"82px"},o[6]=N):N=o[6],o[7]===Symbol.for("react.memo_cache_sentinel")?(O=t.jsx(T.Item,{name:"title",label:"公告标题",required:!0,rules:[{required:!0}],children:t.jsx(I,{placeholder:"公告标题"})}),F=t.jsx(T.Item,{label:"公告内容",required:!0}),o[7]=O,o[8]=F):(O=o[7],F=o[8]),o[9]===Symbol.for("react.memo_cache_sentinel")?(R={height:"calc(300px)"},L=e=>{_(e.text)},o[9]=R,o[10]=L):(R=o[9],L=o[10]),o[11]!==g?(M=t.jsx(y,{className:"flex-1 -mt-4 mb-6",style:R,onChange:L,value:g,renderHTML:z,onImageUpload:S}),o[11]=g,o[12]=M):M=o[12],o[13]===Symbol.for("react.memo_cache_sentinel")?(q=t.jsx(s,{onClick:A,children:"取消"}),o[13]=q):q=o[13];const Q="add"===p?"新增公告":"保存编辑";let U,B;return o[14]!==k||o[15]!==Q?(U=t.jsxs("div",{className:"flex justify-end gap-3 flex-wrap",children:[q,t.jsx(s,{type:"primary",htmlType:"submit",loading:k,children:Q})]}),o[14]=k,o[15]=Q,o[16]=U):U=o[16],o[17]!==c||o[18]!==f||o[19]!==v||o[20]!==U||o[21]!==M?(B=t.jsx(t.Fragment,{children:t.jsxs(T,{form:f,autoComplete:"off",variant:"filled",initialValues:c,labelCol:N,onFinish:v,children:[O,F,M,U]})}),o[17]=c,o[18]=f,o[19]=v,o[20]=U,o[21]=M,o[22]=B):B=o[22],B};function z(e){return t.jsx(w,{content:e,replace:!1})}function A(){r.hide(l)}export{F as default};
