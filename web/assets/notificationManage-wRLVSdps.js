import{x as e,j as t,e as i,B as s,w as o,ao as n,a8 as r,ax as l,ah as a,af as d,a0 as c,ag as m,aj as u,ay as j,az as p,ai as f,H as h}from"./requestIdleCallbackPolyfill-CT2Uunzs.js";import{E as x}from"./index-CqFaBIF0.js";import{u as y}from"./useFresh-CGeh22C4.js";import{M as k,R as b}from"./myTable-DFZSMHtZ.js";import{H as _}from"./handleButton-BzvPHsum.js";import g from"./markdownContent-DKaANkEm.js";import{C as w}from"./contentLayout-odUVCfUr.js";import{R as C}from"./ReloadOutlined-ChGqM_AE.js";import{R as S}from"./QuestionCircleOutlined-B3JZlZLh.js";import{T as N}from"./index-f4najWpg.js";import{R as v}from"./UserOutlined-HtHoo4Ia.js";import{F as O}from"./index-B5l_nge6.js";import{I}from"./index-Dgw5cqVQ.js";import{P as T}from"./main-DyIzdR1k.js";import"./index-BbIXSvcQ.js";import"./LeftOutlined-D9Sp279J.js";import"./MailOutlined-G-2gGlXX.js";import"./Overflow-Dd87tN43.js";import"./mediaQueryUtil-DPPPwwPM.js";import"./index-C1J7OQZZ.js";import"./getAllowClear-BfnEnRnP.js";import"./Input-BiSwrENd.js";import"./transformData-D5arJeXA.js";import"./assets-CmvcfQKP.js";import"./MoneyCollectOutlined-DlFUXkT9.js";import"./MoneyCollectOutlined-4QlEwa2l.js";import"./index-DcBGJWNw.js";import"./styleChecker-Cxx79Q8k.js";import"./AlipayOutlined-OZZKbO3G.js";import"./AlipayOutlined-tZM3mGx9.js";import"./index-CESJ98W-.js";import"./index-C2t7G4dJ.js";import"./useBreakpoint-DKl-R_5q.js";import"./index-kmb97xVR.js";import"./ReloadOutlined-B00s2TmV.js";import"./QuestionCircleOutlined-DSm95oJP.js";import"./row-DFvObsCi.js";import"./TextArea-CCBBim-V.js";function F(){const i=e.c(21),{key:d,refresh:c}=y();let m,u,j,p,f,h;i[0]===Symbol.for("react.memo_cache_sentinel")?(m={title:"创建人",key:"username",width:160,fixed:"left",render:M},u={title:"状态",key:"status",width:80,render:L},j={title:"标题",key:"title",width:200},p={title:"内容",key:"content",width:400},f={type:"time",title:"创建时间",key:"notice_time",width:200},i[0]=m,i[1]=u,i[2]=j,i[3]=p,i[4]=f):(m=i[0],u=i[1],j=i[2],p=i[3],f=i[4]),i[5]!==c?(h=[m,u,j,p,f,{title:"操作",fixed:"right",width:220,render:(e,i)=>t.jsx(R,{record:i,refresh:c})}],i[5]=c,i[6]=h):h=i[6];const x=h;let b,_,g,N,v,O,I;return i[7]===Symbol.for("react.memo_cache_sentinel")?(b=t.jsx(C,{}),i[7]=b):b=i[7],i[8]!==c?(_=t.jsx(s,{type:"primary",icon:b,onClick:()=>{c()},children:"刷新列表"}),i[8]=c,i[9]=_):_=i[9],i[10]===Symbol.for("react.memo_cache_sentinel")?(g=t.jsx(o,{type:"warning",description:t.jsxs(t.Fragment,{children:[t.jsx(S,{className:"mr-1"}),"只会通知最新一条启用的公告！公告新增后需要二次确认是否发布，并且一天只可发布一次公告，以便保证用户体验！"]}),className:"mt-3 p-1 px-3 text-xs font-normal w-full"}),N=t.jsx(n,{className:"my-3"}),i[10]=g,i[11]=N):(g=i[10],N=i[11]),i[12]!==c?(v=t.jsx("div",{className:"mb-3",children:t.jsx(s,{type:"primary",onClick:()=>{r.show(l,{title:"新增公告",children:t.jsx(z,{refresh:c,type:"add"}),width:720})},children:"新增公告"})}),i[12]=c,i[13]=v):v=i[13],i[14]!==x||i[15]!==d?(O=t.jsx(k,{columns:x,getListUrl:a.getNoticeList,dataKey:"data.list",tableKey:d}),i[14]=x,i[15]=d,i[16]=O):O=i[16],i[17]!==v||i[18]!==O||i[19]!==_?(I=t.jsxs(w,{children:[_,g,N,v,O]}),i[17]=v,i[18]=O,i[19]=_,i[20]=I):I=i[20],I}function L(e){return t.jsx(N,{color:0===e?"blue":1===e?"green":"red",children:0===e?"待审核":1===e?"正常":"停用"})}function M(e){return t.jsx(N,{color:e?"geekblue":"red",bordered:!1,icon:t.jsx(v,{}),children:e||"已注销"})}const R=i.memo((o=>{const n=e.c(43),{record:f,refresh:h}=o;let x;n[0]===Symbol.for("react.memo_cache_sentinel")?(x=[],n[0]=x):x=n[0];const[y,k]=i.useState(x);let w;n[1]!==f.id||n[2]!==h?(w=function(){d(0,k);const e=c.getState().user.token;setTimeout((()=>{m({url:a.rejectNotice,token:e,data:{id:f.id}}).then((e=>{200===e.code&&h()})).finally((()=>{u(0,k)}))}),500)},n[1]=f.id,n[2]=h,n[3]=w):w=n[3];const C=w;let S;n[4]!==f.id||n[5]!==h?(S=function(){d(0,k);const e=c.getState().user.token;setTimeout((()=>{m({url:a.confirmNotice,token:e,data:{id:f.id}}).then((e=>{200===e.code&&h()})).finally((()=>{u(0,k)}))}),500)},n[4]=f.id,n[5]=h,n[6]=S):S=n[6];const N=S;let v;n[7]!==f.id||n[8]!==h?(v=function(){d(1,k);const e=c.getState().user.token;setTimeout((()=>{m({url:a.deleteNotice,token:e,data:{id:f.id}}).then((e=>{200===e.code&&h()})).finally((()=>{u(1,k)}))}),500)},n[7]=f.id,n[8]=h,n[9]=v):v=n[9];const O=v;let I;n[10]!==f.content||n[11]!==f.title?(I=function(){j.open({closeIcon:t.jsx("div",{className:"my-handle-icon",children:t.jsx(_,{icon:t.jsx(p,{})})}),message:f.title,description:t.jsx(g,{content:f.content}),duration:null})},n[10]=f.content,n[11]=f.title,n[12]=I):I=n[12];const F=I;let L,M;n[13]!==F?(L=t.jsx(s,{type:"link",size:"small",onClick:F,children:"预览"}),n[13]=F,n[14]=L):L=n[14],n[15]!==f||n[16]!==h?(M=t.jsx(s,{type:"link",size:"small",onClick:()=>{r.show(l,{title:"编辑公告",children:t.jsx(z,{editItem:f,type:"edit",refresh:h}),width:720})},children:"编辑"}),n[15]=f,n[16]=h,n[17]=M):M=n[17];const R=0===f.status||2===f.status?"是否确认发布？":"是否确认停用？",A=0===f.status||2===f.status?N:C;let q,B,H,U,K,P,Q,E,V;return n[18]===Symbol.for("react.memo_cache_sentinel")?(q={width:"44px"},n[18]=q):q=n[18],n[19]!==y[0]||n[20]!==f.status?(B=y[0]?t.jsx(b,{}):0===f.status||2===f.status?"发布":"停用",n[19]=y[0],n[20]=f.status,n[21]=B):B=n[21],n[22]!==y[0]||n[23]!==B?(H=t.jsx(s,{type:"link",size:"small",disabled:y[0],style:q,children:B}),n[22]=y[0],n[23]=B,n[24]=H):H=n[24],n[25]!==H||n[26]!==R||n[27]!==A?(U=t.jsx(T,{title:R,onConfirm:A,children:H}),n[25]=H,n[26]=R,n[27]=A,n[28]=U):U=n[28],n[29]===Symbol.for("react.memo_cache_sentinel")?(K={width:"44px"},n[29]=K):K=n[29],n[30]!==y[1]?(P=y[1]?t.jsx(b,{}):"删除",n[30]=y[1],n[31]=P):P=n[31],n[32]!==y[1]||n[33]!==P?(Q=t.jsx(s,{danger:!0,type:"link",size:"small",disabled:y[1],style:K,children:P}),n[32]=y[1],n[33]=P,n[34]=Q):Q=n[34],n[35]!==O||n[36]!==Q?(E=t.jsx(T,{title:"是否确认删除？",onConfirm:O,children:Q}),n[35]=O,n[36]=Q,n[37]=E):E=n[37],n[38]!==U||n[39]!==E||n[40]!==L||n[41]!==M?(V=t.jsxs("div",{className:"flex flex-wrap",children:[L,M,U,E]}),n[38]=U,n[39]=E,n[40]=L,n[41]=M,n[42]=V):V=n[42],V})),z=o=>{const n=e.c(23),{editItem:d,refresh:u,type:j}=o,p=void 0===j?"add":j,[y]=O.useForm(),[k,b]=i.useState(!1),[_,g]=i.useState(null==d?void 0:d.content);let w;n[0]===Symbol.for("react.memo_cache_sentinel")?(w=function(e){const t=c.getState().user.token;return new Promise((i=>{m({url:a.uploadImage,token:t,data:f({file:e})}).then((e=>{200===e.code&&e.data&&i(e.data.image_url)}))}))},n[0]=w):w=n[0];const C=w;let S;n[1]!==(null==d?void 0:d.id)||n[2]!==_||n[3]!==u||n[4]!==p?(S=function(e){const t=c.getState().user.token;if(!_.trim())return void h.error("请输入公告内容");const i={title:e.title,content:_};b(!0),setTimeout((()=>{m({url:"add"===p?a.addNotice:a.editNotice,token:t,data:"add"===p?i:{id:null==d?void 0:d.id,...i}}).then((e=>{200===e.code&&(u(),r.hide(l))})).finally((()=>{b(!1)}))}),500)},n[1]=null==d?void 0:d.id,n[2]=_,n[3]=u,n[4]=p,n[5]=S):S=n[5];const N=S;let v,T,F,L,M,R,z;n[6]===Symbol.for("react.memo_cache_sentinel")?(v={flex:"82px"},n[6]=v):v=n[6],n[7]===Symbol.for("react.memo_cache_sentinel")?(T=t.jsx(O.Item,{name:"title",label:"公告标题",required:!0,rules:[{required:!0}],children:t.jsx(I,{placeholder:"公告标题"})}),F=t.jsx(O.Item,{label:"公告内容",required:!0}),n[7]=T,n[8]=F):(T=n[7],F=n[8]),n[9]===Symbol.for("react.memo_cache_sentinel")?(L={height:"calc(300px)"},M=e=>{g(e.text)},n[9]=L,n[10]=M):(L=n[9],M=n[10]),n[11]!==_?(R=t.jsx(x,{className:"flex-1 -mt-4 mb-6",style:L,onChange:M,value:_,renderHTML:A,onImageUpload:C}),n[11]=_,n[12]=R):R=n[12],n[13]===Symbol.for("react.memo_cache_sentinel")?(z=t.jsx(s,{onClick:q,children:"取消"}),n[13]=z):z=n[13];const B="add"===p?"新增公告":"编辑";let H,U;return n[14]!==k||n[15]!==B?(H=t.jsxs("div",{className:"flex justify-end gap-3 flex-wrap",children:[z,t.jsx(s,{type:"primary",htmlType:"submit",loading:k,children:B})]}),n[14]=k,n[15]=B,n[16]=H):H=n[16],n[17]!==d||n[18]!==y||n[19]!==N||n[20]!==H||n[21]!==R?(U=t.jsx(t.Fragment,{children:t.jsxs(O,{form:y,autoComplete:"off",variant:"filled",initialValues:d,labelCol:v,onFinish:N,children:[T,F,R,H]})}),n[17]=d,n[18]=y,n[19]=N,n[20]=H,n[21]=R,n[22]=U):U=n[22],U};function A(e){return t.jsx(g,{content:e,replace:!1})}function q(){r.hide(l)}export{F as default};
